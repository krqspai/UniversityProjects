"0","#library(MASS) # ako je potrebno"
"0",""
"0","# stvaramo ""potpuni"" i ""prazni"" model "
"0","lm_sve <- lm(mpg ~ ., data = mtcars)   "
"0","lm_prazan <- lm(mpg ~ 1, data = mtcars)"
"0",""
"0","# pogledajte sažetke gornjih modela kako bi "
"0","# dobili dojam kako rade ""ekstremi"""
"0","summary(lm_sve)"
"1","
Call:
"
"1",""
"1","lm(formula = mpg ~ ., data = mtcars)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-3.4506 "
"1","-1.6044 "
"1","-0.1196 "
"1"," 1.2193 "
"1"," 4.6271 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","  "
"1","
(Intercept)"
"1"," 12.30337"
"1","   18.71788"
"1","   0.657"
"1","   0.5181"
"1","  "
"1","
cyl        "
"1"," -0.11144"
"1","    1.04502"
"1","  -0.107"
"1","   0.9161"
"1","  "
"1","
disp       "
"1","  0.01334"
"1","    0.01786"
"1","   0.747"
"1","   0.4635"
"1","  "
"1","
hp         "
"1"," -0.02148"
"1","    0.02177"
"1","  -0.987"
"1","   0.3350"
"1","  "
"1","
drat       "
"1","  0.78711"
"1","    1.63537"
"1","   0.481"
"1","   0.6353"
"1","  "
"1","
wt         "
"1"," -3.71530"
"1","    1.89441"
"1","  -1.961"
"1","   0.0633"
"1"," ."
"1","
qsec       "
"1","  0.82104"
"1","    0.73084"
"1","   1.123"
"1","   0.2739"
"1","  "
"1","
vs         "
"1","  0.31776"
"1","    2.10451"
"1","   0.151"
"1","   0.8814"
"1","  "
"1","
am         "
"1","  2.52023"
"1","    2.05665"
"1","   1.225"
"1","   0.2340"
"1","  "
"1","
gear       "
"1","  0.65541"
"1","    1.49326"
"1","   0.439"
"1","   0.6652"
"1","  "
"1","
carb       "
"1"," -0.19942"
"1","    0.82875"
"1","  -0.241"
"1","   0.8122"
"1","  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","2.65"
"1"," "
"1","on"
"1"," "
"1","21"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.869"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8066"
"1"," "
"1","
F-statistic:"
"1"," "
"1","13.93"
"1"," "
"1","on"
"1"," "
"1","10"
"1"," "
"1","and"
"1"," "
"1","21"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","3.793e-07"
"1","
"
"1","
"
"0","summary(lm_prazan)"
"1","
Call:
"
"1",""
"1","lm(formula = mpg ~ 1, data = mtcars)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-9.6906 "
"1","-4.6656 "
"1","-0.8906 "
"1"," 2.7094 "
"1","13.8094 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1","   20.091"
"1","      1.065"
"1","   18.86"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","6.027"
"1"," "
"1","on"
"1"," "
"1","31"
"1"," "
"1","degrees of freedom"
"1","
"
"1","
"
"0","# uz pomoć funkcije `stepAIC` stvorite modele `lm1` i `lm2` "
"0","# na sljedeći način"
"0","# `lm1` - nastaje selekcijom ""unatrag"" od punog modela"
"0","#         (parametar direction = ""backward"")"
"0","# `lm2` - nastaje selekcijom ""unaprijed"" od praznog modela"
"0","#         (parametri direction = ""forward"" , "
"0","#         scope = list(upper = lm_sve, lower = lm_prazan))"
"0","#"
"0","# proučite sažetke dobivenih modela"
"0",""
"0","lm1 = stepAIC(lm_sve, direction = ""backward"", trace = 0)"
"0","lm2 = stepAIC(lm_prazan, direction = ""forward"", scope = list(upper = lm_sve, lower = lm_prazan, trace = 0))"
"1","Start:  AIC="
"1",""
"1","115.94"
"1",""
"1","
"
"1",""
"1","mpg ~ 1"
"1",""
"1","

"
"1","      "
"1"," Df"
"1"," Sum of Sq"
"1","     RSS"
"1","     AIC"
"1","
+ wt  "
"1","  1"
"1","    847.73"
"1","  278.32"
"1","  73.217"
"1","
+ cyl "
"1","  1"
"1","    817.71"
"1","  308.33"
"1","  76.494"
"1","
+ disp"
"1","  1"
"1","    808.89"
"1","  317.16"
"1","  77.397"
"1","
+ hp  "
"1","  1"
"1","    678.37"
"1","  447.67"
"1","  88.427"
"1","
+ drat"
"1","  1"
"1","    522.48"
"1","  603.57"
"1","  97.988"
"1","
+ vs  "
"1","  1"
"1","    496.53"
"1","  629.52"
"1","  99.335"
"1","
+ am  "
"1","  1"
"1","    405.15"
"1","  720.90"
"1"," 103.672"
"1","
+ carb"
"1","  1"
"1","    341.78"
"1","  784.27"
"1"," 106.369"
"1","
+ gear"
"1","  1"
"1","    259.75"
"1","  866.30"
"1"," 109.552"
"1","
+ qsec"
"1","  1"
"1","    197.39"
"1","  928.66"
"1"," 111.776"
"1","
<none>"
"1","   "
"1","          "
"1"," 1126.05"
"1"," 115.943"
"1","
"
"1","
Step:  AIC="
"1",""
"1","73.22"
"1",""
"1","
"
"1",""
"1","mpg ~ wt"
"1",""
"1","

"
"1","      "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","    AIC"
"1","
+ cyl "
"1","  1"
"1","    87.150"
"1"," 191.17"
"1"," 63.198"
"1","
+ hp  "
"1","  1"
"1","    83.274"
"1"," 195.05"
"1"," 63.840"
"1","
+ qsec"
"1","  1"
"1","    82.858"
"1"," 195.46"
"1"," 63.908"
"1","
+ vs  "
"1","  1"
"1","    54.228"
"1"," 224.09"
"1"," 68.283"
"1","
+ carb"
"1","  1"
"1","    44.602"
"1"," 233.72"
"1"," 69.628"
"1","
+ disp"
"1","  1"
"1","    31.639"
"1"," 246.68"
"1"," 71.356"
"1","
<none>"
"1","   "
"1","          "
"1"," 278.32"
"1"," 73.217"
"1","
+ drat"
"1","  1"
"1","     9.081"
"1"," 269.24"
"1"," 74.156"
"1","
+ gear"
"1","  1"
"1","     1.137"
"1"," 277.19"
"1"," 75.086"
"1","
+ am  "
"1","  1"
"1","     0.002"
"1"," 278.32"
"1"," 75.217"
"1","
"
"1","
Step:  AIC="
"1",""
"1","63.2"
"1",""
"1","
"
"1",""
"1","mpg ~ wt + cyl"
"1",""
"1","

"
"1","      "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","    AIC"
"1","
+ hp  "
"1","  1"
"1","   14.5514"
"1"," 176.62"
"1"," 62.665"
"1","
+ carb"
"1","  1"
"1","   13.7724"
"1"," 177.40"
"1"," 62.805"
"1","
<none>"
"1","   "
"1","          "
"1"," 191.17"
"1"," 63.198"
"1","
+ qsec"
"1","  1"
"1","   10.5674"
"1"," 180.60"
"1"," 63.378"
"1","
+ gear"
"1","  1"
"1","    3.0281"
"1"," 188.14"
"1"," 64.687"
"1","
+ disp"
"1","  1"
"1","    2.6796"
"1"," 188.49"
"1"," 64.746"
"1","
+ vs  "
"1","  1"
"1","    0.7059"
"1"," 190.47"
"1"," 65.080"
"1","
+ am  "
"1","  1"
"1","    0.1249"
"1"," 191.05"
"1"," 65.177"
"1","
+ drat"
"1","  1"
"1","    0.0010"
"1"," 191.17"
"1"," 65.198"
"1","
"
"1","
Step:  AIC="
"1",""
"1","62.66"
"1",""
"1","
"
"1",""
"1","mpg ~ wt + cyl + hp"
"1",""
"1","

"
"1","      "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","    AIC"
"1","
<none>"
"1","   "
"1","          "
"1"," 176.62"
"1"," 62.665"
"1","
+ am  "
"1","  1"
"1","    6.6228"
"1"," 170.00"
"1"," 63.442"
"1","
+ disp"
"1","  1"
"1","    6.1762"
"1"," 170.44"
"1"," 63.526"
"1","
+ carb"
"1","  1"
"1","    2.5187"
"1"," 174.10"
"1"," 64.205"
"1","
+ drat"
"1","  1"
"1","    2.2453"
"1"," 174.38"
"1"," 64.255"
"1","
+ qsec"
"1","  1"
"1","    1.4010"
"1"," 175.22"
"1"," 64.410"
"1","
+ gear"
"1","  1"
"1","    0.8558"
"1"," 175.76"
"1"," 64.509"
"1","
+ vs  "
"1","  1"
"1","    0.0599"
"1"," 176.56"
"1"," 64.654"
"1","
"
"0","summary(lm1)"
"1","
Call:
"
"1",""
"1","lm(formula = mpg ~ wt + qsec + am, data = mtcars)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-3.4811 "
"1","-1.5555 "
"1","-0.7257 "
"1"," 1.4110 "
"1"," 4.6610 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1","   9.6178"
"1","     6.9596"
"1","   1.382"
"1"," 0.177915"
"1","    "
"1","
wt         "
"1","  -3.9165"
"1","     0.7112"
"1","  -5.507"
"1"," 6.95e-06"
"1"," ***"
"1","
qsec       "
"1","   1.2259"
"1","     0.2887"
"1","   4.247"
"1"," 0.000216"
"1"," ***"
"1","
am         "
"1","   2.9358"
"1","     1.4109"
"1","   2.081"
"1"," 0.046716"
"1"," *  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","2.459"
"1"," "
"1","on"
"1"," "
"1","28"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8497"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8336"
"1"," "
"1","
F-statistic:"
"1"," "
"1","52.75"
"1"," "
"1","on"
"1"," "
"1","3"
"1"," "
"1","and"
"1"," "
"1","28"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","1.21e-11"
"1","
"
"1","
"
"0","summary(lm2)"
"1","
Call:
"
"1",""
"1","lm(formula = mpg ~ wt + cyl + hp, data = mtcars)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-3.9290 "
"1","-1.5598 "
"1","-0.5311 "
"1"," 1.1850 "
"1"," 5.8986 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," 38.75179"
"1","    1.78686"
"1","  21.687"
"1","  < 2e-16"
"1"," ***"
"1","
wt         "
"1"," -3.16697"
"1","    0.74058"
"1","  -4.276"
"1"," 0.000199"
"1"," ***"
"1","
cyl        "
"1"," -0.94162"
"1","    0.55092"
"1","  -1.709"
"1"," 0.098480"
"1"," .  "
"1","
hp         "
"1"," -0.01804"
"1","    0.01188"
"1","  -1.519"
"1"," 0.140015"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","2.512"
"1"," "
"1","on"
"1"," "
"1","28"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8431"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8263"
"1"," "
"1","
F-statistic:"
"1"," "
"1","50.17"
"1"," "
"1","on"
"1"," "
"1","3"
"1"," "
"1","and"
"1"," "
"1","28"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","2.184e-11"
"1","
"
"1","
"
